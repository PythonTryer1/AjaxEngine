var __AjaxEngine={};__AjaxEngine.createXmlHttp=function(){var b;try{return new ActiveXObject("Msxml2.XMLHTTP.4.0")}catch(a){}try{return new ActiveXObject("MSXML2.XMLHTTP")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}try{return new XMLHttpRequest}catch(a){}return null};__AjaxEngine.callServer=function(f,e,i,g,h){var d=null;try{if(f)f=__AjaxEngine.encode(f);if(e&&e!="")e=__AjaxEngine.encode(e);var b="";if(theForm!=null&&theForm.action!=null&&theForm.action!="")b=theForm.action;else b=window.location.href;b=b.split("#")[0];if(b.indexOf("?")>-1)b=b+"&temp="+(new Date).getTime();else b=b+"?temp="+(new Date).getTime();var a=__AjaxEngine.createXmlHttp(),c=null;if(e!=null)c="Action=CallbackServerFunction&FunctionName="+f+"&Parameters="+e;else c="Action=CallbackServerFunction&FunctionName="+f;if(h!=null&&h!="")c+="&"+h;else{theForm.__EVENTTARGET.value="";theForm.__EVENTARGUMENT.value="";c+="&"+__AjaxEngine.createSerializeData()}a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200){d=__AjaxEngine.decode(a.responseText);g!=null&&g(__AjaxEngine.handleMessage(d))}else if(a.status==500){d=__AjaxEngine.decode(a.responseText);document.write(d)}};try{a.open("POST",b,i)}catch(k){a.Open("POST",b,i)}a.setRequestHeader("Content-Length",c.length);a.setRequestHeader("CONTENT-TYPE","application/x-www-form-urlencoded");try{a.send(c)}catch(l){a.Send(c)}if(g==null&&d==null)d=__AjaxEngine.decode(a.responseText)}catch(j){alert("Error: "+j+" \u5728\u56de\u8c03\u670d\u52a1\u7aef\u65f6 ")}return __AjaxEngine.handleMessage(d)};__AjaxEngine.handleMessage=function(rs){if(rs==null)return null;var rv=null,renderData=__AjaxEngine.parseJson(rs.substring(rs.indexOf("--BEGIN--")+9,rs.indexOf("--END--")));if(renderData==null)return null;var count=renderData.length;for(i=0;i<count;i++)if(renderData[i]["type"]=="control"){var ct=document.getElementById(renderData[i]["id"]);if(ct!=null)if(renderData[i]["context"]!="")ct.outerHTML=__AjaxEngine.decode(renderData[i]["context"]);else ct.style.display="none"}else if(renderData[i]["type"]=="message")alert(__AjaxEngine.decode(renderData[i]["context"]));else if(renderData[i]["type"]=="script")eval(__AjaxEngine.decode(renderData[i]["context"]));else if(renderData[i]["type"]=="return")rv=__AjaxEngine.decode(renderData[i]["context"]);else if(renderData[i]["type"]=="viewstate")theForm.__VIEWSTATE.value=__AjaxEngine.decode(renderData[i]["context"]);else if(renderData[i]["type"]=="ajaxviewstate")theForm.__AJAXVIEWSTATE.value=__AjaxEngine.decode(renderData[i]["context"]);return rv};__AjaxEngine.createSerializeData=function(){for(var b=theForm.elements,c={},a=0;a<b.length;a++){var e=b[a].tagName.toLowerCase(),d=b[a].type;if(e=="input"&&(d=="text"||d=="hidden"||d=="password")||e=="textarea"||e=="select")c[b[a].name]=b[a].value;else if(d=="checkbox"||d=="radio")if(d=="checkbox"){if(!c[b[a].name]&&b[a].checked)c[b[a].name]=b[a].value;else if(c[b[a].name]&&b[a].checked)c[b[a].name]+="-"+b[a].value;else if(c[b[a].name]&&c[b[a].name]!="");}else if(b[a].type=="radio")if(b[a].checked)c[b[a].name]=b[a].value;else if(!c[b[a].name]);}var f="____AjaxSubmitForm=true";for(p in c)if(p!="__VIEWSTATE")f+="&"+__AjaxEngine.encode(p)+"="+__AjaxEngine.encode(c[p]);return f};__AjaxEngine.parseJson=function(str){try{return eval("("+str+")")}catch(ex){alert("Error: "+ex+" \u5728\u8f6cjson\u6570\u636e\u65f6 "+str)}};__AjaxEngine.encode=function(a){return encodeURIComponent(a)};__AjaxEngine.decode=function(a){return unescape(a)};__AjaxEngine.getTheForm=function(){var a=null;if(!theForm)a=document.getElementsByTagName("form")[0];else a=theForm;return a};if(typeof HTMLElement!="undefined"&&!window.opera){HTMLElement.prototype.__defineGetter__("outerHTML",function(){for(var b=this.attributes,c="<"+this.tagName,a=0;a<b.length;a++)if(b[a].specified)c+=" "+b[a].name+'="'+b[a].value+'"';if(!this.canHaveChildren)return c+" />";return c+">"+this.innerHTML+"</"+this.tagName+">"});HTMLElement.prototype.__defineSetter__("outerHTML",function(b){var a=this.ownerDocument.createRange();a.setStartBefore(this);var c=a.createContextualFragment(b);this.parentNode.replaceChild(c,this);return b});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){return !/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(this.tagName.toLowerCase())})}String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"gm"),b)}